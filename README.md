# Microsoft Copilot Studio â¤ï¸ MCP

Microsoft Copilot Studio â¤ï¸ MCP ë©ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ì´ ë©ì—ì„œëŠ” MCP ì„œë²„ë¥¼ ë°°í¬í•˜ëŠ” ë°©ë²•ê³¼ Microsoft Copilot Studioì— ì¶”ê°€í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.

## â“ What is MCP?

[Model Context Protocol (MCP)](https://modelcontextprotocol.io/introduction)ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ LLMì— ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ëŠ” ë°©ë²•ì„ í‘œì¤€í™”í•˜ëŠ” ì˜¤í”ˆ í”„ë¡œí† ì½œì…ë‹ˆë‹¤. ì´ í”„ë¡œí† ì½œì€ [Anthropic](https://www.anthropic.com/)ì—ì„œ ì •ì˜í–ˆìŠµë‹ˆë‹¤. MCPëŠ” AI ëª¨ë¸ì„ ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤ì™€ ë„êµ¬ì— ì—°ê²°í•˜ëŠ” í‘œì¤€í™”ëœ ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì œì‘ìëŠ” ê¸°ì¡´ ì§€ì‹ ì„œë²„ì™€ APIë¥¼ Copilot Studioì— ì§ì ‘ í†µí•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í˜„ì¬, Copilot StudioëŠ” Tools(ë„êµ¬)ë§Œ ì§€ì›í•©ë‹ˆë‹¤. í˜„ì¬ ê¸°ëŠ¥ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ [aka.ms/mcsmcp](https://aka.ms/mcsmcp)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”. 

<img width="1920" height="1080" alt="image" src="https://github.com/user-attachments/assets/8e074fea-dcb6-49f5-8bc2-e6d476b42e94" />

> ì´ë¯¸ì§€ì™€ ê´€ë ¨ëœ ì›ë³¸ì€ [ì—¬ê¸°](https://www.claudemcp.com/ko/blog/mcp-vs-api)ì—ì„œ ì°¸ê³ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ†š MCP vs Connectors

âœ… MCPëŠ” ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?

AI ëª¨ë¸ê³¼ ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤ ë˜ëŠ” ë„êµ¬ë¥¼ í‘œì¤€í™”ëœ ë°©ì‹ìœ¼ë¡œ ì—°ê²°í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´, Copilot Studioì—ì„œ ì™¸ë¶€ APIë‚˜ ì§€ì‹ ì„œë²„ë¥¼ ì§ì ‘ í†µí•©í•˜ê³  ì‹¶ì„ ë•Œ MCPê°€ ì í•©í•©ë‹ˆë‹¤.
MCPëŠ” Model Context Protocolì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, LLMì´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì´í•´í•˜ê³  í™œìš©í•  ìˆ˜ ìˆë„ë¡ ë•ìŠµë‹ˆë‹¤.


âœ… ì»¤ë„¥í„°ëŠ” ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?

Power Platformì—ì„œ ê¸°ì¡´ì˜ **ë°ì´í„° ì†ŒìŠ¤(ì˜ˆ: Dynamics 365, SharePoint, SQL ë“±)**ì™€ ì—°ê²°í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
ì»¤ë„¥í„°ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ í†µí•©ì— íŠ¹í™”ë˜ì–´ ìˆìœ¼ë©°, ë°ì´í„° ì‘ì—…ê³¼ ì›Œí¬í”Œë¡œìš° ìë™í™”ì— ê°•ì ì´ ìˆìŠµë‹ˆë‹¤.


âœ… MCPê°€ ì»¤ë„¥í„°ë¥¼ ëŒ€ì²´í•˜ë‚˜ìš”?

ì•„ë‹ˆìš”. MCPëŠ” ì»¤ë„¥í„°ë¥¼ ëŒ€ì²´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
MCP ì„œë²„ëŠ” **ì»¤ë„¥í„° ì¸í”„ë¼**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì œê³µë˜ë¯€ë¡œ, ë‘ ê¸°ìˆ ì€ í•¨ê»˜ ì‚¬ìš©ë©ë‹ˆë‹¤.
MCP ì„œë²„ëŠ” ì»¤ë„¥í„° ì¸í”„ë¼ë¥¼ í™œìš©í•´ ì—”í„°í”„ë¼ì´ì¦ˆ ë³´ì•ˆ ë° ê±°ë²„ë„ŒìŠ¤ ì œì–´ë¥¼ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- V-net í†µí•© ê¸°ëŠ¥: https://learn.microsoft.com/power-platform/admin/vnet-support-overview
- Power Platform DLP ì •ì±…: https://learn.microsoft.com/power-platform/admin/wp-data-loss-prevention
- Custom Connector ë³´í˜¸: https://learn.microsoft.com/connectors/custom-connectors/#2-secure-your-api

ë”°ë¼ì„œ **MCP + ì»¤ë„¥í„°** = ë” ê°•ë ¥í•œ í†µí•©ì…ë‹ˆë‹¤.

## âš™ï¸ Prerequisites

- Visual Studio Code installed ([link](https://code.visualstudio.com/download))
- Node v22 (ideally installed via [nvm for Windows](https://github.com/coreybutler/nvm-windows) or [nvm](https://github.com/nvm-sh/nvm))
- Git installed ([link](https://git-scm.com/downloads))
- Docker installed ([link](http://aka.ms/azure-dev/docker-install))
- Azure Developer CLI installed ([link](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd))
- Azure Subscription (with payment method added)
- GitHub account
- Copilot Studio trial or developer account

## â• í…œí”Œë¦¿ ê¸°ë°˜ì˜ ì‹ ê·œ ê¹ƒëŸ½ ë¦¬í¬ ìƒì„±í•˜ê¸°

1. https://github.com/microsoft/mcsmcp ê¹ƒí—™ ë¦¬í¬ ì ‘ì†í•©ë‹ˆë‹¤.
1. `Use this template` ì„ íƒí•©ë‹ˆë‹¤.
   <img width="1710" height="516" alt="image" src="https://github.com/user-attachments/assets/35c54192-462b-4feb-b199-d586963b631f" />

3. `Create a new repository` ì„ íƒí•©ë‹ˆë‹¤.

    <img width="357" height="237" alt="image" src="https://github.com/user-attachments/assets/b614bb38-b73e-441d-9e0b-172addb1b255" />


1. ì•Œë§ì€ `Owner`ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. (ë³´í†µì€ ë‹¤ìŒê³¼ ê°™ì´ ë³¸ì¸ìœ¼ë¡œ ì§€ì •)
   <img width="806" height="275" alt="image" src="https://github.com/user-attachments/assets/27800d87-c2ee-4e44-ac59-23ac88cf703a" />

1. `Repository name`ì„ ì…ë ¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” **mcsmcp-kr** ì…ë ¥í•©ë‹ˆë‹¤.
1. í•„ìš”í•˜ë‹¤ë©´ `Description` í•­ëª©ì— ë¹„ê³ ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
1. `Private`ì„ ì„ íƒí•©ë‹ˆë‹¤.
1.  `Create repository` ì„ íƒí•©ë‹ˆë‹¤.
   
    ì´ ì‘ì—…ì€ ì‹œê°„ì´ ì¡°ê¸ˆ ê±¸ë¦½ë‹ˆë‹¤. ì™„ë£Œëœ ì´í›„ì— ìƒˆë¡­ê²Œ ìƒì„±ëœ ë¦¬í¬ì§€í† ë¦¬ë¡œ redirect ë©ë‹ˆë‹¤.

## âš–ï¸ ì„ íƒ: ì„œë²„ë¥¼ ë¡œì»¬ë¡œ ì‹¤í–‰í•˜ê±°ë‚˜ Azureì— ë°°í¬

ì´ì œëŠ” ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! :) ì„œë²„ë¥¼ ë¡œì»¬ë¡œ ë™ì‘ì‹œí‚¤ê±°ë‚˜, Azureì— ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ë‹¤ë§Œ, ë‘ ê°€ì§€ ëª¨ë‘ì— ëŒ€í•´ ëª‡ ê°€ì§€ ë‹¨ê³„ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤.

1. ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í˜„ì¬ ê¹ƒí—™ ë¦¬í¬ì§€í† ë¦¬ë¥¼ í´ë¡ í•©ë‹ˆë‹¤. ( `{account}`ë¥¼ ì‚¬ìš©ìì˜ ê¹ƒí—™ ê³„ì • ì´ë¦„ìœ¼ë¡œ ë³€ê²½)

`git clone https://github.com/{account}/mcsmcp-kr.git`

> ì˜ˆì‹œ: ì €ëŠ” git clone https://github.com/ChangJu-Ahn/mcsmcp-KRìœ¼ë¡œ ì…ë ¥í–ˆìŠµë‹ˆë‹¤.

<img width="1039" height="383" alt="image" src="https://github.com/user-attachments/assets/946f336b-6f83-461a-9039-f2e6f5bbb68d" />

2. ë¹„ì£¼ì–¼ ìŠ¤íŠœë””ì˜¤ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , ë¦¬í¬ì§€í† ë¦¬ë¥¼ í´ë¡ í•´ ë‘” í´ë”ê²½ë¡œë¥¼ `open` í•©ë‹ˆë‹¤.
   
   <img width="378" height="379" alt="image" src="https://github.com/user-attachments/assets/b4f7a583-e0c6-4763-8564-1519e09b88b3" />
   
4. í„°ë¯¸ë„ì„ ì—´ê³ , í´ë¡ ëœ í´ë” ê²½ë¡œë¡œ ì´ë™í•©ë‹ˆë‹¤.
   
   <img width="618" height="378" alt="image" src="https://github.com/user-attachments/assets/6f3f14a4-ea1a-4b41-8072-d52e9f3c4fc6" />

### ğŸƒâ€â™€ï¸ Run the MCP Server Locally

1. í„°ë¯¸ë„ ì°½ì—ì„œ `npm install` ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
1. ê·¸ë¦¬ê³  `npm run build && npm run start` ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

    <img width="389" height="137" alt="image" src="https://github.com/user-attachments/assets/008424dd-9e43-4b68-9c19-39bc0c23938f" />


1.  í„°ë¯¸ë„ ì˜†ì— íƒ­ ì°½ì—ì„œ `PORTS` ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.

    <img width="407" height="141" alt="image" src="https://github.com/user-attachments/assets/88614f7a-7e88-44a4-a93a-8eba2a420b17" />


1. ì´ˆë¡ìƒ‰ì˜ `Forward a Port` ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.

   <img width="421" height="101" alt="image" src="https://github.com/user-attachments/assets/a7cbfb0d-8217-4aa6-8a6d-c2ea730d12eb" />

1. í¬íŠ¸ ë²ˆí˜¸ë¡œ `3000`ì„ ì…ë ¥í•˜ì„¸ìš”. (ë‹¨, ìœ„ì—ì„œ í‘œí˜„ëœ í¬íŠ¸ë²ˆí˜¸ì™€ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤)
GitHubì— ë¡œê·¸ì¸í•˜ë¼ëŠ” ë©”ì‹œì§€ê°€ í‘œì‹œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í¬íŠ¸ í¬ì›Œë”© ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìˆ˜ì´ë¯€ë¡œ, ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.

<img width="1083" height="293" alt="image" src="https://github.com/user-attachments/assets/306fdd85-2fde-4055-a7cf-85f1e5270e5d" />

1. ë°©ê¸ˆ ì¶”ê°€í•œ í–‰ì„ ë§ˆìš°ìŠ¤ ì˜¤ë¥¸ìª½ ë²„íŠ¼ìœ¼ë¡œ í´ë¦­í•˜ê³ , `Port visibility` > `Public`ë¥¼ ì„ íƒí•˜ì—¬ ì„œë²„ë¥¼ ê³µê°œì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
1. ë‹¤ìŒ íŒì—…ì—ì„œ `Copy`ë¥¼ ì„ íƒí•˜ì—¬ URLì„ ë³µì‚¬í•©ë‹ˆë‹¤.

    ![View of the PORTS setup with highlighted the port, the forwarded address and the visibility](./assets/vscode-terminal-ports-setup.png) 

1. ì›í•˜ëŠ” ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³  ì£¼ì†Œì°½ì— URLì„ ë¶™ì—¬ë„£ê³ , ë’¤ì— `/mcp`ë¥¼ ì…ë ¥í•œ í›„ Enter í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”.    
   ëª¨ë“  ê³¼ì •ì´ ì •ìƒì ìœ¼ë¡œ ì§„í–‰ë˜ì—ˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.

```json
{"jsonrpc":"2.0","error":{"code":-32000,"message":"Method not allowed."},"id":null}
```

ê±±ì •í•˜ì§€ ë§ˆì„¸ìš”. ì´ ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” ê±±ì •í•  ê²ƒì´ ì „í˜€ ì—†ìŠµë‹ˆë‹¤! ì´ì œë¶€í„° ë§Œë“¤ ì˜ˆì •ì´ë‹ˆê¹Œìš”! :)

<img width="744" height="201" alt="image" src="https://github.com/user-attachments/assets/e304a624-c332-4828-89aa-1f4339519ed1" />


### ğŸŒ Azure í´ë¼ìš°ë“œ ë°°í¬

> [!important]
> ì´ì „ [prerequisites](#ï¸-prerequisites)ì— ì„¤ëª…ëœ ë‚´ìš© ê¸°ì¤€ìœ¼ë¡œ, the [Azure Developer CLI ](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd) ì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ ì»´í“¨í„°ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë§Œì•½ ì„¤ì¹˜ê°€ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´, `azd version` ëª…ë ¹ì–´ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

<img width="697" height="279" alt="image" src="https://github.com/user-attachments/assets/ce4dad84-0253-459f-8c01-dfb172d400cd" />

ê·¸ë¦¬ê³  ì•„ì§ Azure Developer CLIì— ë¡œê·¸ì¸í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ê¼­ ë¡œê·¸ì¸í•˜ì„¸ìš”.

```azurecli
azd auth login
```

<img width="650" height="231" alt="image" src="https://github.com/user-attachments/assets/a066fce7-b864-4b51-afab-4729390a652b" />

> [!WARNING]  
> `azd up` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ Azure ìœ„ì—ì„œ ë™ì‘í•˜ëŠ” í¼ë¸”ë¦­í•˜ê²Œ ë™ì‘í•˜ëŠ” MCP Serverê°€ ë°°í¬ë©ë‹ˆë‹¤. ì´ëŠ” ë¹„ìš©ì´ ì§€ì†ì ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì›í•˜ì§€ ì•Šì„ ê²½ìš° ì‹¤ìŠµ í›„ `azd down` ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” Azure êµ¬ë…ìœ¼ë¡œ ë°°í¬ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ì œê±°í•˜ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤. `azd down` ê´€ë ¨í•œ ìì„¸í•œ ë‚´ìš©ì€ [ì—¬ê¸°](#-remove-the-azure-resources)ë¥¼ ì°¸ê³ í•´ ì£¼ì„¸ìš”. 

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ ì°½ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤. 

```azurecli
azd up
```

ì´í›„ ì¶”ê°€ì ìœ¼ë¡œ ì…ë ¥í•  ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
- Unique environment name(Resource Group Nanme): `mcsmcplab`
- Azure Subscription: í…Œë„ŒíŠ¸ ë‚´ êµ¬ë…ì´ ì—¬ëŸ¬ê°€ì§€ë¼ë©´, ì‚¬ìš©í•˜ê³ ì í•˜ëŠ” êµ¬ë…ì„ ì„ íƒí•©ë‹ˆë‹¤. í•œ ê°œë§Œ ìˆë‹¤ë©´ ë°”ë¡œ ì„ íƒí•©ë‹ˆë‹¤.
- Location: Korea Central
  
<img width="836" height="247" alt="image" src="https://github.com/user-attachments/assets/87fceb5d-b366-42ea-99e0-cf6e4b76ceb8" />

ëª…ë ¹ì–´ ì‹¤í–‰ í›„ ë°°í¬ë  ë•Œê¹Œì§€ ì•½ê°„ì˜ ì‹œê°„ì´ í•„ìš”í•©ë‹ˆë‹¤. ë°°í¬ê°€ ì™„ë£Œëœ ë’¤ì— ë‹¤ìŒê³¼ ê°™ì€ URLì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í•´ë‹¹ URL ë’¤ì— `/mcp`ì„ ë¶™ì—¬ ë¸Œë¼ìš°ì €ì—ì„œ ì§ì ‘ í™•ì¸í•´ ë´…ë‹ˆë‹¤.

<img width="844" height="262" alt="image" src="https://github.com/user-attachments/assets/9cac0119-63d0-44c9-8bb2-656ad3e6e762" />
<img width="809" height="262" alt="image" src="https://github.com/user-attachments/assets/5a064113-f6ef-414c-8c31-5f858fc80782" />

> ìœ„ URLì€ portal.azure.comìœ¼ë¡œ ë“¤ì–´ì™€ì„œ ë°°í¬ëœ Container Appsì—ì„œë„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<img width="1437" height="447" alt="image" src="https://github.com/user-attachments/assets/e36ade88-f391-4310-bd5f-40a9340cb241" />



You should again see the following error:

```json
{"jsonrpc":"2.0","error":{"code":-32000,"message":"Method not allowed."},"id":null}
```

## ğŸ‘¨â€ğŸ’» Visual Studio Code/GitHub Copilotì—ì„œ Jokes MCP ì„œë²„ ì‚¬ìš©í•˜ê¸°

Jokes MCP ì„œë²„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„œë²„ì˜ URL(devtunnel URLì´ë‚˜ ë°°í¬í•œ Azure Container Appì´ ë  ìˆ˜ ìˆìŒ)ì˜ ëì— `/mcp` ë¶€ë¶„ì„ ì¶”ê°€í•˜ê³  Visual Studio Codeì—ì„œ MCP ì„œë²„ë¡œ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.

1. Press either `ctrl` + `shift` + `P` (Windows/Linux) or `cmd` + `shift` + `P` (Mac) and type `MCP`
1. Select `MCP: Add Server...`
1. Select `HTTP (HTTP or Server-Sent Events)`
1. Paste the URL of your server in the input box (make sure `/mcp` in the end is included)
1. Press `Enter`
1. Enter a name for the server, for instance `JokesMCP`
1. Select `User Settings` to save the MCP Server settings in your user settings

    This will add an MCP Server to your `settings.json` file. It should look like this:
    ![settings.json file](./assets/settings.png)

1. Open `GitHub Copilot`
1. Switch from `Ask` to `Agent`
1. Make sure the `JokesMCP` server actions are selected when you select the tools icon:

    ![Tools menu in GitHub Copilot](./assets/tools-menu.png)

1. Ask the following question:

    ```text
    Get a chuck norris joke from the Dev category
    ```

This should give you a response like this:

![Screenshot of question to provide a joke from the dev category and the answer from GitHub Copilot](./assets/github-copilot-get-joke.png)

Now you have added the `JokesMCP` server to Visual Studio Code!

## ğŸ‘¨â€ğŸ’» Use the Jokes MCP Server in Microsoft Copilot Studio

**Import the Connector**

1. Go to https://make.preview.powerapps.com/customconnectors (make sure youâ€™re in the correct environment) and click **+ New custom connector**. 
1. Select `Import from GitHub`
1. Select `Custom` as **Connector Type**
1. Select `dev` as the **Branch**
1. Select `MCP-Streamable-HTTP` as the **Connector**
1. Select `Continue`

    ![View of the import from GitHub section](./assets/import-from-github.png)

1. Change the **Connector Name** to something appropriate, like for instance `Jokes MCP` 
1. Change the **Description** to something appropriate
1. Paste your root URL (for instance `something-3000.something.devtunnels.ms` or `something.azurecontainerapps.io`) in the **Host** field
1. Select **Create connector** 

> [!WARNING]  
> You may see a warning and an error upon creation â€“ it should be resolved soon - but you can ignore it for now.

11. Close the connector


**Create an agent and add the MCP server as a tool**

1. Go to https://copilotstudio.preview.microsoft.com/
1. Select the environment picker at the top right corner
1. Select the right environment (the environment with the `Get new features early` toggle switched on)
1. Select `Create` in the left navigation
1. Select the blue `New agent` button

    ![New agent](./assets/newagent.png)

1. Select the `Configure` tab on the left

    ![Configure](./assets/configure.png)

1. Change the name to `Jokester`
1. Add the following `Description`

    ```text
    A humor-focused agent that delivers concise, engaging jokes only upon user request, adapting its style to match the user's tone and preferences. It remains in character, avoids repetition, and filters out offensive content to ensure a consistently appropriate and witty experience.
    ```

1. Add the following `Instructions`

    ```text
    You are a joke-telling assistant. Your sole purpose is to deliver appropriate, clever, and engaging jokes upon request. Follow these rules:
    
    * Respond only when the user asks for a joke or something related (e.g., "Tell me something funny").
    * Match the tone and humor preference of the user based on their inputâ€”clean, dark, dry, pun-based, dad jokes, etc.
    * Never break character or provide information unrelated to humor.
    * Keep jokes concise and clearly formatted.
    * Avoid offensive, discriminatory, or NSFW content.
    * When unsure about humor preference, default to a clever and universally appropriate joke.
    * Do not repeat jokes within the same session.
    * Avoid explaining the joke unless explicitly asked.
    * Be responsive, witty, and quick.
    ```

1. Select `Continue` on the top right

    ![Click continue to create agent](./assets/continue.png)

1. Enable Generative AI `Orchestration`

    ![Turn on orchestration](./assets/turnonorchestration.png)

1. Disable general knowledge in the `Knowledge` section

    ![Turn off general knowledge](./assets/turnoffgeneralknowledge.png)

1. Select `Tools` in the top menu
 
    ![Tools](./assets/tools.png)

1. Select `Add a tool`

    ![Add a tool](./assets/addatool.png)

1. Select the `Model Context Protocol` tab to filter all the Model Context Protocol Servers (see number 1 in the screenshot below)

1. Select the `Jokes MCP` server (see number 2 in the screenshot below)

    ![MCP](./assets/mcpsteps.png)

1. Create a new connection by selecting the `Not connected` and **Create new Connection**

    ![Action and connection](./assets/create-connection-action.png)

1. Select `Create`

    ![Create connection](./assets/create-connection-action-create.png)

1. Select `Add to agent` to add the tool to the agent

    ![Add tool to agent](./assets/add-tool-to-agent.png)

1. Select the `refresh icon` in the `Test your agent` pane

    ![Refresh testing pane](./assets/refreshtestingpane.png)

1. In the `Test your agent` pane send the following message:

    ```text
    Can I get a Chuck Norris joke?
    ```
  
    This will show you message that additional permissions are required to run this action. This is because of the user authentication in the action wizard.

1. Select `Connect`

    ![Additional permissions](./assets/additionalpermissions.png)
  
    This will open a new window where you can manage your connections for this agent.

1. Select `Connect` next to the `JokesMCP`

    ![Connect to JokesMCP](./assets/connect.png)

1. Wait until the connection is created and select `Submit`

    ![Pick a connection](./assets/submitconnection.png)

1. The connection should now be connected, so the status should be set to `Connected`

    ![Status connected](./assets/connected.png) 

1. Close the manage your connections tab in your browser

    Now you should be back in the Jokester agent screen.

1. Select the `refresh icon` in the `Test your agent` pane

    ![Refresh testing pane](./assets/refreshtestingpane.png)

1. In the `Test your agent` pane send the following message:

    ```text
    Can I get a Chuck Norris joke?
    ```

    This will now show a Chuck Norris joke - instead of the additional permissions. If that's not the case - you probably have missed the [prerequisite](#ï¸-prerequisites) that the environment needs to have the `get new features early` toggle on.

    ![Chuck Norris joke](./assets/chucknorrisjoke.png)

1. In the `Test your agent` pane send the following message:

    ```text
    Can I get a Dad joke?
    ```

    This will now show a Dad joke.

    ![Dad joke](./assets/dadjoke.png)

And that was the Jokes MCP Server working in Microsoft Copilot Studio.

## âŒ Remove the Azure resources

To remove the Azure resources after finishing the lab, run the following command in the terminal:

```azurecli
azd down
```
This command will show you the resources that will be deleted and then ask you to confirm. Confirm with `y` and the resources will be deleted. This can take a couple of minutes, but at the end you will see a confirmation:

![resources deleted](./assets/azd-down-confirmation.png)

## ğŸ’¡ Known issues and planned improvements

There are some known issues and planned improvements for MCP in Microsoft Copilot Studio. They are listed in [this Microsoft Learn article](https://aka.ms/mcsmcpdocs#known-issues--planned-improvements).

## ğŸ—£ï¸ Feedback

Hopefully you liked the lab. Please take the time to fill in our [feedback form](https://aka.ms/mcsmcp/lab/feedback) to tell us how we can improve!

## ğŸš€ Contributing

This project welcomes contributions and suggestions.  Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution. For details, visit https://cla.opensource.microsoft.com.

When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment). Simply follow the instructions
provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or
contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.

## â„¢ï¸ Trademarks

This project may contain trademarks or logos for projects, products, or services. Authorized use of Microsoft 
trademarks or logos is subject to and must follow 
[Microsoft's Trademark & Brand Guidelines](https://www.microsoft.com/legal/intellectualproperty/trademarks/usage/general).
Use of Microsoft trademarks or logos in modified versions of this project must not cause confusion or imply Microsoft sponsorship.
Any use of third-party trademarks or logos are subject to those third-party's policies.

![Microsoft Copilot Studio â¤ï¸ MCP](https://m365-visitor-stats.azurewebsites.net/?resource=https://github.com/microsoft/mcsmcp)
